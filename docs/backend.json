{
  "entities": {
    "Tour": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tour",
      "type": "object",
      "description": "Represents a tour offered by Babdodo Tours & Safaris.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tour.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "Name of the tour."
        },
        "description": {
          "type": "string",
          "description": "Description of the tour."
        },
        "status": {
          "type": "string",
          "description": "Status of the tour (e.g., active, inactive)."
        },
        "price": {
          "type": "number",
          "description": "Price of the tour.",
          "format": "float"
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image for the tour.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the tour was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the tour was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Safari": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Safari",
      "type": "object",
      "description": "Represents a safari offered by Babdodo Tours & Safaris.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the safari.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "Name of the safari."
        },
        "description": {
          "type": "string",
          "description": "Description of the safari."
        },
        "status": {
          "type": "string",
          "description": "Status of the safari (e.g., active, inactive)."
        },
        "price": {
          "type": "number",
          "description": "Price of the safari.",
          "format": "float"
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image for the safari.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the safari was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the safari was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Transfer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transfer",
      "type": "object",
      "description": "Represents a transfer service offered by Babdodo Tours & Safaris.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transfer service.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "Name of the transfer service (e.g., airport to hotel)."
        },
        "description": {
          "type": "string",
          "description": "Description of the transfer service."
        },
        "status": {
          "type": "string",
          "description": "Status of the transfer service (e.g., active, inactive)."
        },
        "price": {
          "type": "number",
          "description": "Price of the transfer service.",
          "format": "float"
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image for the transfer service.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the transfer service was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the transfer service was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "NewsUpdate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "NewsUpdate",
      "type": "object",
      "description": "Represents a news article or blog post.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the news update.",
          "format": "uuid"
        },
        "title": {
          "type": "string",
          "description": "Title of the news update."
        },
        "content": {
          "type": "string",
          "description": "Full content of the news update."
        },
        "status": {
          "type": "string",
          "description": "Status of the news update (e.g., active, inactive)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the news update was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the news update was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "content"
      ]
    },
    "AdminUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AdminUser",
      "type": "object",
      "description": "Represents an administrator user of the system.  Note: Passwords should be managed by an external authentication provider.  This entity stores supplementary admin user data.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the admin user.",
          "format": "uuid"
        },
        "username": {
          "type": "string",
          "description": "Admin's username."
        },
        "role": {
          "type": "string",
          "description": "Role of the user (admin, superadmin, etc.)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the admin user was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the admin user was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "username"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/tours/{tourId}",
        "definition": {
          "entityName": "Tour",
          "schema": {
            "$ref": "#/backend/entities/Tour"
          },
          "description": "Stores tour details. Accessible only by admins.",
          "params": [
            {
              "name": "tourId",
              "description": "Unique identifier for the tour."
            }
          ]
        }
      },
      {
        "path": "/safaris/{safariId}",
        "definition": {
          "entityName": "Safari",
          "schema": {
            "$ref": "#/backend/entities/Safari"
          },
          "description": "Stores safari details. Accessible only by admins.",
          "params": [
            {
              "name": "safariId",
              "description": "Unique identifier for the safari."
            }
          ]
        }
      },
      {
        "path": "/transfers/{transferId}",
        "definition": {
          "entityName": "Transfer",
          "schema": {
            "$ref": "#/backend/entities/Transfer"
          },
          "description": "Stores transfer details. Accessible only by admins.",
          "params": [
            {
              "name": "transferId",
              "description": "Unique identifier for the transfer."
            }
          ]
        }
      },
      {
        "path": "/news_updates/{newsUpdateId}",
        "definition": {
          "entityName": "NewsUpdate",
          "schema": {
            "$ref": "#/backend/entities/NewsUpdate"
          },
          "description": "Stores news updates and blog posts. Accessible only by admins.",
          "params": [
            {
              "name": "newsUpdateId",
              "description": "Unique identifier for the news update."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{adminUserId}",
        "definition": {
          "entityName": "AdminUser",
          "schema": {
            "$ref": "#/backend/entities/AdminUser"
          },
          "description": "Collection to store admin user roles. Existence of a document indicates admin privileges.",
          "params": [
            {
              "name": "adminUserId",
              "description": "User ID of the admin.  Corresponds to Firebase Auth UID."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the Babdodo Tours & Safaris application, focusing on secure access control and data integrity. It leverages structural segregation and denormalization to ensure authorization independence and simplify security rules. The structure is designed to support CRUD operations by admins via a dedicated admin dashboard.\n\n**Core Principles and Strategies Applied:**\n\n*   **Authorization Independence:** All collections are designed to avoid hierarchical authorization dependencies (`get()` calls in security rules). Admin access is controlled via the `/roles_admin/{uid}` collection. Denormalization is not used in this structure as all collections are only accessible to admins.\n*   **Structural Segregation:** Each data type (tours, safaris, transfers, news updates, and admin users) resides in its own top-level collection. This segregation simplifies security rules by ensuring that all documents within a collection share the same access control requirements.\n*   **Access Modeling:** Admin access is modeled using the **Existence over Content** strategy. The presence of a document in the `/roles_admin/{uid}` collection grants admin privileges.\n*   **Data Clarity and Predictability:** Each document follows a predictable schema based on the provided data entities. Timestamps (`createdAt`, `updatedAt`) are included for auditing and data management.\n\n**Explanation of QAPs Support (Rules are not Filters):**\n\n*   The segregation of data into distinct collections (e.g., `/tours`, `/safaris`, `/transfers`, `/news_updates`) allows for efficient and secure `list` operations. Security rules can be applied at the collection level to ensure that only authorized admins can access the data.\n\n**Authorization Independence Details**\n\nAuthorization Independence is achieved by limiting collections to a single access profile (admin only). This removes the need for `get()` calls in security rules as all data within each collection is treated equally from an access control perspective. Security rules can simply check if a user is an admin (by verifying existence in the `/roles_admin` collection), and then grant full CRUD access to any of the data collections. There is no need to check any data elements in any documents. No data fields are copied to implement Authorization Independence, this reduces complexity in data storage, and updating data. This approach simplifies data updating.\n\nThe architecture supports the core application features, including the admin dashboard, image management, content recommendations, contact form, and WhatsApp integration."
  }
}